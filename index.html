<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Game Night Picker</title>
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; padding: 20px; background: #f0f2f5; text-align: center; }
        .container { max-width: 400px; margin: auto; background: white; padding: 30px; border-radius: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        h2 { color: #333; margin-bottom: 20px; }
        
        .input-group { display: flex; gap: 10px; margin-bottom: 20px; }
        input { flex-grow: 1; padding: 12px; border: 2px solid #ddd; border-radius: 8px; font-size: 16px; outline: none; transition: 0.3s; }
        input:focus { border-color: #007bff; }
        
        button { padding: 12px 20px; cursor: pointer; border-radius: 8px; border: none; font-weight: bold; transition: 0.2s; font-size: 16px; }
        button:hover { opacity: 0.9; transform: scale(1.02); }
        button:active { transform: scale(0.98); }
        
        .add-btn { background: #28a745; color: white; }
        .pick-btn { background: #007bff; color: white; width: 100%; margin-top: 10px; font-size: 18px; padding: 15px; box-shadow: 0 4px 0 #0056b3; }
        .pick-btn:active { box-shadow: 0 2px 0 #0056b3; transform: translateY(2px); }

        ul { list-style: none; padding: 0; text-align: left; margin-top: 20px; max-height: 300px; overflow-y: auto; }
        li { background: #f8f9fa; margin: 8px 0; padding: 12px; display: flex; justify-content: space-between; align-items: center; border-radius: 8px; border-left: 5px solid #28a745; animation: fadeIn 0.3s; }
        
        .delete-btn { color: #dc3545; cursor: pointer; font-weight: bold; padding: 5px 10px; border-radius: 5px; }
        .delete-btn:hover { background: #ffe6e6; }

        #result { margin: 20px 0; font-size: 26px; color: #333; font-weight: 800; min-height: 40px; display: flex; align-items: center; justify-content: center; }
        .winner { color: #28a745 !important; transform: scale(1.1); transition: 0.3s; }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>

<div class="container">
    <h2>ðŸŽ² Board Game Picker</h2>
    
    <div class="input-group">
        <input type="text" id="gameInput" placeholder="Enter game name..." onkeypress="handleEnter(event)">
        <button class="add-btn" onclick="addGame()">Add</button>
    </div>

    <div id="result">Waiting to play...</div>
    <button class="pick-btn" onclick="pickGame()">WHAT SHOULD WE PLAY?</button>

    <ul id="gameList"></ul>
</div>

<script>
    // 1. Safe State Management
    let games = JSON.parse(localStorage.getItem('myBoardGames')) || [];

    // 2. Optimized UI Update (Security Fix)
    function updateUI() {
        const list = document.getElementById('gameList');
        list.innerHTML = '';
        
        games.forEach((game, index) => {
            const li = document.createElement('li');
            
            // Create text node safely
            const textSpan = document.createElement('span');
            textSpan.textContent = game;
            
            const deleteBtn = document.createElement('span');
            deleteBtn.className = 'delete-btn';
            deleteBtn.innerHTML = 'âœ•'; // Using a nice UTF-8 symbol
            deleteBtn.onclick = () => removeGame(index);
            
            li.appendChild(textSpan);
            li.appendChild(deleteBtn);
            list.appendChild(li);
        });
        
        localStorage.setItem('myBoardGames', JSON.stringify(games));
    }

    // 3. Add Game Logic
    function addGame() {
        const input = document.getElementById('gameInput');
        const value = input.value.trim();
        
        if (value) {
            games.push(value);
            input.value = "";
            updateUI();
            input.focus(); // Keep focus on input for rapid entry
        }
    }

    // 4. Handle "Enter" Key
    function handleEnter(event) {
        if (event.key === "Enter") {
            addGame();
        }
    }

    function removeGame(index) {
        games.splice(index, 1);
        updateUI();
    }

    // 5. The "Roulette" Animation Effect
    function pickGame() {
        const resultDiv = document.getElementById('result');
        resultDiv.className = ''; // Reset styling
        
        if (games.length === 0) {
            resultDiv.innerText = "Add some games first!";
            resultDiv.style.color = "#dc3545";
            return;
        }
        
        if (games.length === 1) {
            resultDiv.innerText = games[0];
            resultDiv.classList.add('winner');
            return;
        }

        // Animation logic
        let counter = 0;
        const cycles = 20; // How many flicks before stopping
        const speed = 100; // Speed in ms

        const interval = setInterval(() => {
            const randomIndex = Math.floor(Math.random() * games.length);
            resultDiv.innerText = games[randomIndex];
            counter++;

            if (counter >= cycles) {
                clearInterval(interval);
                // Final winning pick (ensure it feels random)
                const winnerIndex = Math.floor(Math.random() * games.length);
                resultDiv.innerText = "Let's play: " + games[winnerIndex] + "!";
                resultDiv.classList.add('winner');
            }
        }, 80);
    }

    // Initialize list on load
    updateUI();
</script>

</body>
</html>
